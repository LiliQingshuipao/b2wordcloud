!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.B2wordcloud=e():t.B2wordcloud=e()}(this,function(){return function(t){function e(o){if(i[o])return i[o].exports;var a=i[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){var i;for(i in e)t[i]=t[i]&&"[object Object]"===t[i].toString()?a(t[i],e[i]):t[i]=e[i];return t}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1),s=e.B2wordcloud=function(){function t(e,i){o(this,t),this._wrapper=e,this._wrapper.style.position="relative",this._container=null,this._tooltip=null,this._options=a({renderer:"canvas",tooltip:{show:!0,formatter:null}},i),this._wordcloud2=null,this._maskCanvas=null,this._tempCanvas=null,this._init()}return n(t,[{key:"_init",value:function(){this._initContainer(),this._setOptions()}},{key:"_initContainer",value:function(){"div"===this._options.renderer?(this._container=document.createElement("div"),this._container.style.width="100%",this._container.style.height="100%",this._createTempCanvas()):"canvas"===this._options.renderer&&(this._container=document.createElement("canvas"),this._setCanvasSize()),this._wrapper.appendChild(this._container)}},{key:"_createTempCanvas",value:function(){this._tempCanvas=document.createElement("canvas"),this._setCanvasSize(this._tempCanvas)}},{key:"_initTooltip",value:function(){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className=this._options.tooltip.className||"",this._tooltip.style.backgroundColor=this._options.tooltip.backgroundColor||"rgba(0,0,0,0.8)",this._tooltip.style.color="#fff",this._tooltip.style.padding="5px",this._tooltip.style.borderRadius="5px",this._tooltip.style.fontSize="13px",this._tooltip.style.lineHeight="1.4",this._tooltip.style.webkitTransition="left 0.2s, top 0.2s",this._tooltip.style.transition="left 0.2s, top 0.2s",this._tooltip.style.position="absolute",this._tooltip.style.whiteSpace="nowrap",this._tooltip.style.zIndex="999",this._tooltip.style.display="none"),document.body.appendChild(this._tooltip)}},{key:"_setCanvasSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._container,e=this._wrapper.clientWidth,i=this._wrapper.clientHeight;t.width=e,t.height=i}},{key:"_setOptions",value:function(){var t=this;if(this._fixWeightFactor(this._options),this._options.tooltip.show){this._initTooltip();var e=void 0,i=void 0,o=void 0,a=void 0,n=this._options.hover,r=this._options.mouseout;this._options.mouseout=function(){r&&r(),t._tooltip.style.display="none"},this._options.hover=function(r,s,l){if(n&&n(r,s,l),r){var h=r[0]+": "+r[1];"[object Function]"===Object.prototype.toString.call(t._options.tooltip.formatter)&&(h=t._options.tooltip.formatter(r)),t._tooltip.style.display="block",e=t._tooltip.clientWidth,i=t._tooltip.clientHeight,o=i+15,a=e/2+5,t._tooltip.style.position="absolute",t._tooltip.style.top=l.pageY-o+"px",t._tooltip.style.left=l.pageX-a+"px",t._tooltip.innerHTML=h}else t._tooltip.style.display="none"}}this._options&&this._options.maskImage?this._maskImage():this._render()}},{key:"_maskImage",value:function(){var t=this,e=window.document.createElement("img");e.crossOrigin="Anonymous",e.src=this._options.maskImage,e.onload=function(){t._maskCanvas=document.createElement("canvas"),t._maskCanvas.width=e.width,t._maskCanvas.height=e.height;var i=t._maskCanvas.getContext("2d");i.drawImage(e,0,0,e.width,e.height);for(var o=i.getImageData(0,0,t._maskCanvas.width,t._maskCanvas.height),a=i.createImageData(o),n=0;n<o.data.length;n+=4){var r=o.data[n]+o.data[n+1]+o.data[n+2],s=o.data[n+3];s<128||r>384?(a.data[n]=a.data[n+1]=a.data[n+2]=255,a.data[n+3]=0):(a.data[n]=a.data[n+1]=a.data[n+2]=0,a.data[n+3]=255)}i.putImageData(a,0,0),t._render()}}},{key:"_render",value:function(){if(this._maskCanvas){this._options.clearCanvas=!1;var t=document.createElement("canvas").getContext("2d");t.fillStyle=this._options.backgroundColor||"#fff",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1).data,i=document.createElement("canvas");i.width="canvas"===this._options.renderer?this._container.width:this._container.clientWidth,i.height="canvas"===this._options.renderer?this._container.height:this._container.clientHeight;var o=i.getContext("2d");o.drawImage(this._maskCanvas,0,0,this._maskCanvas.width,this._maskCanvas.height,0,0,i.width,i.height);for(var a=o.getImageData(0,0,i.width,i.height),n=o.createImageData(a),s=0;s<a.data.length;s+=4)a.data[s+3]>128?(n.data[s]=e[0],n.data[s+1]=e[1],n.data[s+2]=e[2],n.data[s+3]=e[3]):(n.data[s]=e[0],n.data[s+1]=e[1],n.data[s+2]=e[2],n.data[s+3]=e[3]?e[3]-1:0);o.putImageData(n,0,0);var l=this._tempCanvas?this._tempCanvas:this._container;o=l.getContext("2d"),o.drawImage(i,0,0)}this._wordcloud2=new r("canvas"===this._options.renderer?this._container:[this._tempCanvas,this._container],this._options)}},{key:"_fixWeightFactor",value:function(t){if(t.maxFontSize="number"==typeof t.maxFontSize?t.maxFontSize:36,t.minFontSize="number"==typeof t.minFontSize?t.minFontSize:6,t.list&&t.list.length>0){for(var e=Number(t.list[0][1]),i=0,o=0,a=t.list.length;o<a;o++){var n=Number(t.list[o][1]);e>n&&(e=n),i<n&&(i=n)}i>e?t.weightFactor=function(o){var a=i-e,n=t.maxFontSize-t.minFontSize;return 0===a?0===n?t.minFontSize:(t.minFontSize+t.maxFontSize)/2:o===e?t.minFontSize:o===i?t.maxFontSize:(o-e)/a*n+t.minFontSize}:t.weightFactor=function(e){return t.minFontSize}}}},{key:"resize",value:function(){"canvas"===this._options.renderer?this._setCanvasSize():"div"===this._options.renderer&&(this._container.textContent=""),this._render()}},{key:"dispatchAction",value:function(t){switch(t.type){case"highlight":this._wordcloud2.highlight(t.dataIndex,t.keepAlive);break;case"downplay":this._wordcloud2.downplay(t.dataIndex,t.keepAlive)}}}]),t}();t.exports=s},function(t,e,i){function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a,n;(function(){/*!
	   * wordcloud2.js
	   * http://timdream.org/wordcloud2.js/
	   *
	   * Copyright 2011 - 2013 Tim Chien
	   * Released under the MIT license
	   */
"use strict";window.setImmediate||(window.setImmediate=function(){return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var t=[void 0],e="zero-timeout-message",i=function(i){var o=t.length;return t.push(i),window.postMessage(e+o.toString(36),"*"),o};return window.addEventListener("message",function(i){if("string"==typeof i.data&&i.data.substr(0,e.length)===e){i.stopImmediatePropagation();var o=parseInt(i.data.substr(e.length),36);t[o]&&(t[o](),t[o]=void 0)}},!0),window.clearImmediate=function(e){t[e]&&(t[e]=void 0)},i}()||function(t){window.setTimeout(t,0)}}()),window.clearImmediate||(window.clearImmediate=function(){return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(t){window.clearTimeout(t)}}()),function(i){var r=function(){var t=document.createElement("canvas");if(!t||!t.getContext)return!1;var e=t.getContext("2d");return!!e&&(!!e.getImageData&&(!!e.fillText&&(!!Array.prototype.some&&!!Array.prototype.push)))}(),s=function(){if(r){for(var t,e,i=document.createElement("canvas").getContext("2d"),o=20;o;){if(i.font=o.toString(10)+"px sans-serif",i.measureText("Ｗ").width===t&&i.measureText("m").width===e)return o+1;t=i.measureText("Ｗ").width,e=i.measureText("m").width,o--}return 0}}(),l=function(t){for(var e,i,o=t.length;o;e=Math.floor(Math.random()*o),i=t[--o],t[o]=t[e],t[e]=i);return t},h=function(t,e){function i(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"}if(r){Array.isArray(t)||(t=[t]),t.forEach(function(e,i){if("string"==typeof e){if(t[i]=document.getElementById(e),!t[i])throw"The element id specified is not found."}else if(!e.tagName&&!e.appendChild)throw"You must pass valid HTML elements, or ID of the element."});var a={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null,cursorWhenHover:"pointer",mouseout:null},n=this;if(n.words=[],n.elements=t,e)for(var h in e)h in a&&(a[h]=e[h]);if("function"!=typeof a.weightFactor){var c=a.weightFactor;a.weightFactor=function(t){return t*c}}if("function"!=typeof a.shape)switch(a.shape){case"circle":default:a.shape="circle";break;case"cardioid":a.shape=function(t){return 1-Math.sin(t)};break;case"diamond":a.shape=function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))};break;case"square":a.shape=function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))};break;case"triangle-forward":a.shape=function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"triangle":case"triangle-upright":a.shape=function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"pentagon":a.shape=function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))};break;case"star":a.shape=function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}a.gridSize=Math.max(Math.floor(a.gridSize),4);var d,f,u,m,p,v,g,w=a.gridSize,b=w-a.maskGapWidth,x=Math.abs(a.maxRotation-a.minRotation),y=Math.abs(Math.floor(a.rotationSteps)),_=Math.min(a.maxRotation,a.minRotation);switch(a.color){case"random-dark":g=function(){return i(10,50)};break;case"random-light":g=function(){return i(50,90)};break;default:"function"==typeof a.color&&(g=a.color)}var C;"function"==typeof a.fontWeight&&(C=a.fontWeight);var M=null;"function"==typeof a.classes&&(M=a.classes);var k,S=!1,T=[],I=function(t){var e,i,o=t.currentTarget,a=o.getBoundingClientRect();t.touches?(e=t.touches[0].clientX,i=t.touches[0].clientY):(e=t.clientX,i=t.clientY);var n=e-a.left,r=i-a.top,s=Math.floor(n*(o.width/a.width||1)/w),l=Math.floor(r*(o.height/a.height||1)/w);return T[s][l]},E=function(){a.mouseout()},O=function(t){var e=I(t);if(k!==e){if(k=e,!e)return a.hover(void 0,void 0,t),void(t.target.style.cursor="default");"pointer"===a.cursorWhenHover&&(t.target.style.cursor="pointer"),a.hover(e.item,e.dimension,t)}},F=function(t){var e=I(t);e&&(a.click(e.item,e.dimension,t,e.index),t.preventDefault())},z=[],j=function(t){if(z[t])return z[t];var e=8*t,i=e,o=[];for(0===t&&o.push([m[0],m[1],0]);i--;){var n=1;"circle"!==a.shape&&(n=a.shape(i/e*2*Math.PI)),o.push([m[0]+t*n*Math.cos(-i/e*2*Math.PI),m[1]+t*n*Math.sin(-i/e*2*Math.PI)*a.ellipticity,i/e*2*Math.PI])}return z[t]=o,o},R=function(){return a.abortThreshold>0&&(new Date).getTime()-v>a.abortThreshold},L=function(){return 0===a.rotateRatio?0:Math.random()>a.rotateRatio?0:0===x?_:y>0?_+Math.floor(Math.random()*y)*x/(y-1):_+Math.random()*x},P=function(t,e,i){var o=!1,n=a.weightFactor(e);if(n<=a.minSize)return!1;var r=1;n<s&&(r=function(){for(var t=2;t*n<s;)t+=2;return t}());var l;l=C?C(t,e,n):a.fontWeight;var h=document.createElement("canvas"),c=h.getContext("2d",{willReadFrequently:!0});c.font=l+" "+(n*r).toString(10)+"px "+a.fontFamily;var d=c.measureText(t).width/r,f=Math.max(n*r,c.measureText("m").width,c.measureText("Ｗ").width)/r,u=d+2*f,m=3*f,p=Math.ceil(u/w),v=Math.ceil(m/w);u=p*w,m=v*w;var g=-d/2,b=.4*-f,x=Math.ceil((u*Math.abs(Math.sin(i))+m*Math.abs(Math.cos(i)))/w),y=Math.ceil((u*Math.abs(Math.cos(i))+m*Math.abs(Math.sin(i)))/w),_=y*w,M=x*w;h.setAttribute("width",_),h.setAttribute("height",M),o&&(document.body.appendChild(h),c.save()),c.scale(1/r,1/r),c.translate(_*r/2,M*r/2),c.rotate(-i),c.font=l+" "+(n*r).toString(10)+"px "+a.fontFamily,c.fillStyle="#000",c.textBaseline="middle",c.fillText(t,g*r,(b+.5*n)*r);var k=c.getImageData(0,0,_,M).data;if(R())return!1;o&&(c.strokeRect(g*r,b,d*r,f*r),c.restore());for(var S,T,I,E=[],O=y,F=[x/2,y/2,x/2,y/2];O--;)for(S=x;S--;){I=w;t:{for(;I--;)for(T=w;T--;)if(k[4*((S*w+I)*_+(O*w+T))+3]){E.push([O,S]),O<F[3]&&(F[3]=O),O>F[1]&&(F[1]=O),S<F[0]&&(F[0]=S),S>F[2]&&(F[2]=S),o&&(c.fillStyle="rgba(255, 0, 0, 0.5)",c.fillRect(O*w,S*w,w-.5,w-.5));break t}o&&(c.fillStyle="rgba(0, 0, 255, 0.5)",c.fillRect(O*w,S*w,w-.5,w-.5))}}return o&&(c.fillStyle="rgba(0, 255, 0, 0.5)",c.fillRect(F[3]*w,F[0]*w,(F[1]-F[3]+1)*w,(F[2]-F[0]+1)*w)),{mu:r,occupied:E,bounds:F,gw:y,gh:x,fillTextOffsetX:g,fillTextOffsetY:b,fillTextWidth:d,fillTextHeight:f,fontSize:n}},W=function(t,e,i,o,n){for(var r=n.length;r--;){var s=t+n[r][0],l=e+n[r][1];if(s>=f||l>=u||s<0||l<0){if(!a.drawOutOfBound)return!1}else if(!d[s][l])return!1}return!0};n.drawItem=function(t,e){t&&(B(t.gx,t.gy,t.info,t.word,t.weight,t.distance,t.theta,t.rotateDeg,t.attributes,t.i,t.highlight),X(t.gx,t.gy,t.gw,t.gh,t.info,t.item,t.i))};var A=function(t,e,i,o,a,n,r,s){t.beginPath(0),t.save(),t.moveTo(e+n,i),t.lineTo(e+o-n,i),t.arcTo(e+o,i,e+o,i+n,n),t.lineTo(e+o,i+a-n),t.arcTo(e+o,i+a,e+o-n,i+a,n),t.lineTo(e+n,i+a),t.arcTo(e,i+a,e,i+a-n,n),t.lineTo(e,i+n),t.arcTo(e,i,e+n,i,n),t.closePath(),t.fillStyle=r,t.fill(),t.lineWidth="1",t.strokeStyle=s,t.stroke(),t.restore()},D=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,o=t.toLowerCase();if(o&&i.test(o)){if(4===o.length){for(var a="#",n=1;n<4;n+=1)a+=o.slice(n,n+1).concat(o.slice(n,n+1));o=a}for(var r=[],s=1;s<7;s+=2)r.push(parseInt("0x"+o.slice(s,s+2)));return"rgba("+r.join(",")+","+e+")"}return o.startsWith("rgba")?o.split(",").map(function(t,e){return 3===e&&(t=" 0.2)"),t}).join(","):o},B=function(i,n,r,s,l,h,c,d,f,u,m){var p,v=r.fontSize;p=g?g(s,l,v,h,c):a.color;var b;b=C?C(s,l,v):a.fontWeight;var x;x=M?M(s,l,v):a.classes;var y,_=r.bounds;y={x:(i+_[3])*w,y:(n+_[0])*w,w:(_[1]-_[3]+1)*w,h:(_[2]-_[0]+1)*w};var k,S,T,I=!1,E="left";"[object Array]"===Object.prototype.toString.call(p)&&(k=p[u%p.length],p=k,"[object Array]"===Object.prototype.toString.call(k)&&(I=!0),I&&"[object Number]"!==Object.prototype.toString.call(k[k.length-1])&&(k[k.length]=0),E=0===k[k.length-1]?"top":"left"),T=JSON.parse(JSON.stringify(p)),t.forEach(function(t,l){if(t.getContext){var h=t.getContext("2d"),c=r.mu;if(h.save(),h.scale(1/c,1/c),h.font=b+" "+(v*c).toString(10)+"px "+a.fontFamily,I){var u=h.measureText(s).width;S=h.createLinearGradient("top"!==E?-u/2:0,"top"===E?-v/2:0,"top"!==E?u/2:0,"top"===E?v/2:0);for(var l=0;l<k.length-1;l++)S.addColorStop(l/(k.length-2),k[l]);p=S}if(h.fillStyle=p,h.translate((i+r.gw/2)*w*c,(n+r.gh/2)*w*c),m){var g;if(I){g=h.createLinearGradient("top"!==E?-r.fillTextOffsetX*c-4/c/2:0,"top"===E?-r.fillTextOffsetY*c-4/c/2:0,"top"!==E?r.fillTextOffsetX*c-4/c/2:0,"top"===E?r.fillTextOffsetY*c-4/c/2:0);for(var l=0;l<k.length-1;l++)g.addColorStop(l/(k.length-2),D(k[k.length-2-l],.2))}A(h,r.fillTextOffsetX*c-2/c,r.fillTextOffsetY*c-2/c,h.measureText(s).width+4/c,v+4/c,4/c,I?g:D(k?k:p,.2),I?k[0]:k?k:p)}h.shadowColor=e.shadowColor,h.shadowOffsetX=e.shadowOffsetX,h.shadowOffsetY=e.shadowOffsetY,h.shadowBlur=e.shadowBlur,0!==d&&h.rotate(-d),h.textBaseline="middle",h.fillText(s,r.fillTextOffsetX*c,(r.fillTextOffsetY+.5*v)*c),h.restore()}else{I&&(p=k);var y=document.createElement("div"),_=document.createElement("span"),C="";C="rotate("+-d/Math.PI*180+"deg) ",1!==r.mu&&(C+="translateX(-"+r.fillTextWidth/4+"px) scale("+1/r.mu+")");var M={position:"absolute",left:(i+r.gw/2)*w+r.fillTextOffsetX+"px",top:(n+r.gh/2)*w+r.fillTextOffsetY+"px",width:r.fillTextWidth+"px","box-sizing":"border-box","border-radius":"4px","border-style":"solid","border-width":"1px","border-color":"transparent",lineHeight:v+"px",whiteSpace:"nowrap",transform:C,webkitTransform:C,msTransform:C,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%",font:b+" "+v*r.mu+"px "+a.fontFamily},T={display:"block",font:b+" "+v*r.mu+"px "+a.fontFamily,filter:"drop-shadow("+e.shadowOffsetX+"px "+e.shadowOffsetY+"px "+e.shadowBlur+"px "+e.shadowColor+")"};m&&(M=Object.assign(M,o({"border-color":I?p[0]:p,"border-style":"solid","border-width":"1px"},"border-color",I?p[0]:p)),I?M.backgroundImage="-webkit-linear-gradient("+E+","+p.filter(function(t,e){return e!=p.length-1}).map(function(t){return D(t,.2)}).join(",")+")":M.backgroundColor=D(p,.2)),p&&("[object Array]"===Object.prototype.toString.call(p)&&(T=Object.assign({webkitBackgroundClip:"text",webkitTextFillColor:"transparent",backgroundImage:"-webkit-linear-gradient("+E+","+p.filter(function(t,e){return e!=p.length-1}).join(",")+")"},T)),T.color=p),_.textContent=s;for(var O in M)y.style[O]=M[O];for(var O in T)_.style[O]=T[O];if(f)for(var F in f)_.setAttribute(F,f[F]);x&&(_.className+=x),y.appendChild(_),t.appendChild(y)}})},H=function(e,i,o,a,n,r){if(!(e>=f||i>=u||e<0||i<0)){if(d[e][i]=!1,o){var s=t[0].getContext("2d");s.fillRect(e*w,i*w,b,b)}S&&(T[e][i]={item:n,dimension:a,index:r})}},X=function(e,i,o,n,r,s,l){var h,c=r.occupied,d=a.drawMask;d&&(h=t[0].getContext("2d"),h.save(),h.fillStyle=a.maskColor);var m;if(S){var p=r.bounds;m={x:(e+p[3])*w,y:(i+p[0])*w,w:(p[1]-p[3]+1)*w,h:(p[2]-p[0]+1)*w}}for(var v=c.length;v--;){var g=e+c[v][0],b=i+c[v][1];g>=f||b>=u||g<0||b<0||H(g,b,d,m,s,l)}d&&h.restore()},Y=function(t,e){var i,o,r,s,h=e;Array.isArray(t)?(i=t[0],o=t[1],s=t[2]):(i=t.word,o=t.weight,r=t.attributes,s=t.highlight);var c=L(),d=P(i,o,c);if(!d)return!1;if(R())return!1;if(!a.drawOutOfBound){var m=d.bounds;if(m[1]-m[3]+1>f||m[2]-m[0]+1>u)return!1}for(var v=p+1,g=function(e,a){var l=Math.floor(e[0]-d.gw/2),h=Math.floor(e[1]-d.gh/2),c=d.gw,f=d.gh;if(!W(l,h,c,f,d.occupied))return!1;var u={gx:l,gy:h,info:d,word:i,weight:o,distance:p-v,theta:e[2],attributes:r,item:t,i:a,highlight:s};return n.words.push(u),u};v--;){var w=j(p-v);a.shuffle&&(w=[].concat(w),l(w));for(var b,e=0;e<w.length;e++){var x=g(w[e],h);if(x){b=x;break}}if(b)return b}return!1},N=function(e,i,o){return i?!t.some(function(t){var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,!0,i,o||{}),!t.dispatchEvent(a)},this):void t.forEach(function(t){var a=document.createEvent("CustomEvent");a.initCustomEvent(e,!0,i,o||{}),t.dispatchEvent(a)},this)},q=function(){var e=t[0];if(e.getContext)f=Math.ceil(e.width/w),u=Math.ceil(e.height/w);else{var i=e.getBoundingClientRect();f=Math.ceil(i.width/w),u=Math.ceil(i.height/w)}if(N("wordcloudstart",!0)){m=a.origin?[a.origin[0]/w,a.origin[1]/w]:[f/2,u/2],p=Math.floor(Math.sqrt(f*f+u*u)),d=[];var o,r,s;if(!e.getContext||a.clearCanvas)for(t.forEach(function(t){if(t.getContext){var e=t.getContext("2d");e.fillStyle=a.backgroundColor,e.clearRect(0,0,f*(w+1),u*(w+1)),e.fillRect(0,0,f*(w+1),u*(w+1))}else t.textContent="",t.style.backgroundColor=a.backgroundColor,t.style.position="relative"}),o=f;o--;)for(d[o]=[],r=u;r--;)d[o][r]=!0;else{var l=document.createElement("canvas").getContext("2d");l.fillStyle=a.backgroundColor,l.fillRect(0,0,1,1);var h=l.getImageData(0,0,1,1).data,c=e.getContext("2d").getImageData(0,0,f*w,u*w).data;o=f;for(var g,b;o--;)for(d[o]=[],r=u;r--;){b=w;t:for(;b--;)for(g=w;g--;)for(s=4;s--;)if(c[4*((r*w+b)*f*w+(o*w+g))+s]!==h[s]){d[o][r]=!1;break t}d[o][r]!==!1&&(d[o][r]=!0)}c=l=h=void 0}if(a.hover||a.click){for(S=!0,o=f+1;o--;)T[o]=[];var x=function(t){t.preventDefault()};t.forEach(function(t){a.hover&&(t.addEventListener("mousemove",O),t.addEventListener("mouseout",E)),a.click&&(t.addEventListener("click",F),t.addEventListener("touchstart",F),t.addEventListener("touchend",x),t.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),t.addEventListener("wordcloudstart",function e(){t.removeEventListener("wordcloudstart",e),t.removeEventListener("mousemove",O),t.removeEventListener("mouseout",E),t.removeEventListener("click",F),t.removeEventListener("touchstart",F),t.removeEventListener("touchend",x),k=void 0})})}s=0;var y,_;0!==a.wait?(y=window.setTimeout,_=window.clearTimeout):(y=window.setImmediate,_=window.clearImmediate);var C=function(e,i){t.forEach(function(t){t.addEventListener(e,i)},this)},M=function(e,i){t.forEach(function(t){t.removeEventListener(e,i)},this)},I=function t(){M("wordcloudstart",t),_(z)};C("wordcloudstart",I);var z=y(function t(){if(s>=a.list.length)return _(z),N("wordcloudstop",!1),void M("wordcloudstart",I);v=(new Date).getTime();var e=Y(a.list[s],s);n.drawItem(e);var i=!N("wordclouddrawn",!0,{item:a.list[s],drawn:e&&!0});return R()||i?(_(z),a.abort(),N("wordcloudabort",!1),N("wordcloudstop",!1),void M("wordcloudstart",I)):(s++,void(z=y(t,a.wait)))},a.wait)}};return q(),this}};h.prototype.highlight=function(t,e){var i=this;i.elements.forEach(function(o,a){o.getContext?o.getContext("2d").clearRect(0,0,o.width,o.height):o.innerHTML="",i.words.forEach(function(o){e||(o.highlight=!1),o.i===t&&(o.highlight=!0),i.drawItem(o)})})},h.prototype.downplay=function(t,e){var i=this;i.elements.forEach(function(e,o){e.getContext?e.getContext("2d").clearRect(0,0,e.width,e.height):e.innerHTML="",i.words.forEach(function(e){e.i===t&&(e.highlight=!1),i.drawItem(e)})})},h.isSupported=r,h.minFontSize=s,i.WordCloud=h,a=[],n=function(){return h}.apply(e,a),!(void 0!==n&&(t.exports=n))}(this)}).call(window)}])});