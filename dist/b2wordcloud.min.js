!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.B2wordcloud=e():t.B2wordcloud=e()}(this,function(){return function(t){function e(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){var i;for(i in e)t[i]=t[i]&&"[object Object]"===t[i].toString()?n(t[i],e[i]):t[i]=e[i];return t}function a(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),o=e.createImageData(i),n=0,a=0,r=0;r<i.data.length;r+=4){var s=i.data[r+3];if(s>128){var l=i.data[r]+i.data[r+1]+i.data[r+2];n+=l,++a}}for(var h=n/a,r=0;r<i.data.length;r+=4){var l=i.data[r]+i.data[r+1]+i.data[r+2],s=i.data[r+3];s<128||l>h?(o.data[r]=0,o.data[r+1]=0,o.data[r+2]=0,o.data[r+3]=0):(o.data[r]=255,o.data[r+1]=255,o.data[r+2]=255,o.data[r+3]=255)}e.putImageData(o,0,0)}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=i(1),l=e.B2wordcloud=function(){function t(e,i){o(this,t),this._wrapper=e,this._wrapper.style.position="relative",this._container=null,this._tooltip=null,this._options=n({renderer:"canvas",tooltip:{show:!0,formatter:null},clearCanvas:!i.maskImage},i),this._wordcloud2=null,this._maskCanvas=null,this._tempCanvas=null,this._maskImg=null,this._init()}return r(t,[{key:"_init",value:function(){this._initContainer(),this._setOptions()}},{key:"_initContainer",value:function(){this._maskCanvas=document.createElement("canvas"),this._setCanvasSize(this._maskCanvas),"div"===this._options.renderer?(this._container=document.createElement("div"),this._container.style.width="100%",this._container.style.height="100%",this._createTempCanvas()):"canvas"===this._options.renderer&&(this._container=document.createElement("canvas"),this._setCanvasSize()),this._wrapper.appendChild(this._container)}},{key:"_createTempCanvas",value:function(){this._tempCanvas=document.createElement("canvas"),this._setCanvasSize(this._tempCanvas)}},{key:"_initTooltip",value:function(){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className=this._options.tooltip.className||"",this._tooltip.style.backgroundColor=this._options.tooltip.backgroundColor||"rgba(0,0,0,0.8)",this._tooltip.style.color="#fff",this._tooltip.style.padding="5px",this._tooltip.style.borderRadius="5px",this._tooltip.style.fontSize="13px",this._tooltip.style.lineHeight="1.4",this._tooltip.style.webkitTransition="left 0.2s, top 0.2s",this._tooltip.style.transition="left 0.2s, top 0.2s",this._tooltip.style.position="absolute",this._tooltip.style.whiteSpace="nowrap",this._tooltip.style.zIndex="999",this._tooltip.style.display="none"),document.body.appendChild(this._tooltip)}},{key:"_setCanvasSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._container,e=this._wrapper.clientWidth,i=this._wrapper.clientHeight;t.width=e,t.height=i,t.style.width=e+"px",t.style.height=i+"px"}},{key:"_setOptions",value:function(){var t=this;if(this._fixWeightFactor(this._options),this._options.tooltip.show){this._initTooltip();var e=void 0,i=void 0,o=void 0,n=void 0,a=this._options.hover,r=this._options.mouseout;this._options.mouseout=function(){r&&r(),t._tooltip.style.display="none"},this._options.hover=function(r,s,l){if(a&&a(r,s,l),r){var h=r[0]+": "+r[1];"[object Function]"===Object.prototype.toString.call(t._options.tooltip.formatter)&&(h=t._options.tooltip.formatter(r)),t._tooltip.style.display="block",e=t._tooltip.clientWidth,i=t._tooltip.clientHeight,o=i+15,n=e/2+5,t._tooltip.style.position="absolute",t._tooltip.style.top=l.pageY-o+"px",t._tooltip.style.left=l.pageX-n+"px",t._tooltip.innerHTML=h}else t._tooltip.style.display="none"}}this._options&&this._options.maskImage?this._maskImage():this._render()}},{key:"_maskImage",value:function(){var t=this,e=window.document.createElement("img");e.crossOrigin="Anonymous",e.src=this._options.maskImage,e.onload=function(){t._maskImg=e,t._render()}}},{key:"_render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._maskImg){var e=this._maskCanvas,i=e.getContext("2d");i.drawImage(this._maskImg,0,0,e.width,e.height),a(e)}this._wordcloud2=new s("canvas"===this._options.renderer?this._container:[this._tempCanvas,this._container],this._options,this._maskCanvas,t)}},{key:"_fixWeightFactor",value:function(t){if(t.maxFontSize="number"==typeof t.maxFontSize?t.maxFontSize:36,t.minFontSize="number"==typeof t.minFontSize?t.minFontSize:6,t.list&&t.list.length>0){for(var e=Number(t.list[0][1]),i=0,o=0,n=t.list.length;o<n;o++){var a=Number(t.list[o][1]);e>a&&(e=a),i<a&&(i=a)}i>e?t.weightFactor=function(o){var n=i-e,a=t.maxFontSize-t.minFontSize;return 0===n?0===a?t.minFontSize:(t.minFontSize+t.maxFontSize)/2:o===e?t.minFontSize:o===i?t.maxFontSize:(o-e)/n*a+t.minFontSize}:t.weightFactor=function(e){return t.minFontSize}}}},{key:"resize",value:function(){"canvas"===this._options.renderer?this._setCanvasSize():"div"===this._options.renderer&&(this._container.textContent=""),this._maskCanvas&&this._setCanvasSize(this._maskCanvas),this._render()}},{key:"dispatchAction",value:function(t){switch(t.type){case"highlight":this._wordcloud2.highlight(t.dataIndex,t.keepAlive);break;case"downplay":this._wordcloud2.downplay(t.dataIndex,t.keepAlive)}}}]),t}();t.exports=l},function(t,e,i){function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var n,a;(function(){/*!
	   * wordcloud2.js
	   * http://timdream.org/wordcloud2.js/
	   *
	   * Copyright 2011 - 2013 Tim Chien
	   * Released under the MIT license
	   */
"use strict";window.setImmediate||(window.setImmediate=function(){return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var t=[void 0],e="zero-timeout-message",i=function(i){var o=t.length;return t.push(i),window.postMessage(e+o.toString(36),"*"),o};return window.addEventListener("message",function(i){if("string"==typeof i.data&&i.data.substr(0,e.length)===e){i.stopImmediatePropagation();var o=parseInt(i.data.substr(e.length),36);t[o]&&(t[o](),t[o]=void 0)}},!0),window.clearImmediate=function(e){t[e]&&(t[e]=void 0)},i}()||function(t){window.setTimeout(t,0)}}()),window.clearImmediate||(window.clearImmediate=function(){return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(t){window.clearTimeout(t)}}()),function(i){var r=function(){var t=document.createElement("canvas");if(!t||!t.getContext)return!1;var e=t.getContext("2d");return!!e&&(!!e.getImageData&&(!!e.fillText&&(!!Array.prototype.some&&!!Array.prototype.push)))}(),s=function(){if(r){for(var t,e,i=document.createElement("canvas").getContext("2d"),o=20;o;){if(i.font=o.toString(10)+"px sans-serif",i.measureText("Ｗ").width===t&&i.measureText("m").width===e)return o+1;t=i.measureText("Ｗ").width,e=i.measureText("m").width,o--}return 0}}(),l=function(t){for(var e,i,o=t.length;o;e=Math.floor(Math.random()*o),i=t[--o],t[o]=t[e],t[e]=i);return t},h=function(t,e,i){function n(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"}if(r){Array.isArray(t)||(t=[t]);var a=function(t){var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e},h=null,c=1;t.forEach(function(e,i){if(e.getContext&&e.getContext("2d")&&(h=e,c=a(e.getContext("2d"))),"string"==typeof e){if(t[i]=document.getElementById(e),!t[i])throw"The element id specified is not found."}else if(!e.tagName&&!e.appendChild)throw"You must pass valid HTML elements, or ID of the element."});var d={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null,cursorWhenHover:"pointer",mouseout:null},f=this;if(f.words=[],f.elements=t,e)for(var u in e)u in d&&(d[u]=e[u]);if("function"!=typeof d.weightFactor){var m=d.weightFactor;d.weightFactor=function(t){return t*m}}if("function"!=typeof d.shape)switch(d.shape){case"circle":default:d.shape="circle";break;case"cardioid":d.shape=function(t){return 1-Math.sin(t)};break;case"diamond":d.shape=function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))};break;case"square":d.shape=function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))};break;case"triangle-forward":d.shape=function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"triangle":case"triangle-upright":d.shape=function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"pentagon":d.shape=function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))};break;case"star":d.shape=function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}d.gridSize=Math.max(Math.floor(d.gridSize),4);var p,v,g,w,x,b,y,_=d.gridSize,k=_-d.maskGapWidth,C=Math.abs(d.maxRotation-d.minRotation),M=Math.abs(Math.floor(d.rotationSteps)),S=Math.min(d.maxRotation,d.minRotation);switch(d.color){case"random-dark":y=function(){return n(10,50)};break;case"random-light":y=function(){return n(50,90)};break;default:"function"==typeof d.color&&(y=d.color)}var T;"function"==typeof d.fontWeight&&(T=d.fontWeight);var I=null;"function"==typeof d.classes&&(I=d.classes);var E,O=!1,F=[],z=function(t){var e,i,o=t.currentTarget,n=o.getBoundingClientRect();t.touches?(e=t.touches[0].clientX,i=t.touches[0].clientY):(e=t.clientX,i=t.clientY);var a=e-n.left,r=i-n.top,s=Math.floor(a*(o.width/n.width/c||1)/_),l=Math.floor(r*(o.height/n.height/c||1)/_);return F[s][l]},P=function(){d.mouseout()},R=function(t){var e=z(t);if(E!==e){if(E=e,!e)return d.hover(void 0,void 0,t),void(t.target.style.cursor="default");"pointer"===d.cursorWhenHover&&(t.target.style.cursor="pointer"),d.hover(e.item,e.dimension,t)}},j=function(t){var e=z(t);e&&(d.click(e.item,e.dimension,t,e.index),t.preventDefault())},L=[],A=function(t){if(L[t])return L[t];var e=8*t,i=e,o=[];for(0===t&&o.push([w[0],w[1],0]);i--;){var n=1;"circle"!==d.shape&&(n=d.shape(i/e*2*Math.PI)),o.push([w[0]+t*n*Math.cos(-i/e*2*Math.PI),w[1]+t*n*Math.sin(-i/e*2*Math.PI)*d.ellipticity,i/e*2*Math.PI])}return L[t]=o,o},B=function(){return d.abortThreshold>0&&(new Date).getTime()-b>d.abortThreshold},W=function(){return 0===d.rotateRatio?0:Math.random()>d.rotateRatio?0:0===C?S:M>0?S+Math.floor(Math.random()*M)*C/(M-1):S+Math.random()*C},D=function(t,e,i){var o=!1,n=d.weightFactor(e);if(n<=d.minSize)return!1;var a=1;n<s&&(a=function(){for(var t=2;t*n<s;)t+=2;return t}());var r;r=T?T(t,e,n):d.fontWeight;var l=document.createElement("canvas"),h=l.getContext("2d",{willReadFrequently:!0});h.font=r+" "+(n*a).toString(10)+"px "+d.fontFamily;var c=h.measureText(t).width/a,f=Math.max(n*a,h.measureText("m").width,h.measureText("Ｗ").width)/a,u=c+2*f,m=3*f,p=Math.ceil(u/_),v=Math.ceil(m/_);u=p*_,m=v*_;var g=-c/2,w=.4*-f,x=Math.ceil((u*Math.abs(Math.sin(i))+m*Math.abs(Math.cos(i)))/_),b=Math.ceil((u*Math.abs(Math.cos(i))+m*Math.abs(Math.sin(i)))/_),y=b*_,k=x*_;l.setAttribute("width",y),l.setAttribute("height",k),o&&(document.body.appendChild(l),h.save()),h.scale(1/a,1/a),h.translate(y*a/2,k*a/2),h.rotate(-i),h.font=r+" "+(n*a).toString(10)+"px "+d.fontFamily,h.fillStyle="#000",h.textBaseline="middle",h.fillText(t,g*a,(w+.5*n)*a);var C=h.getImageData(0,0,y,k).data;if(B())return!1;o&&(h.strokeRect(g*a,w,c*a,f*a),h.restore());for(var M,S,I,E=[],O=b,F=[x/2,b/2,x/2,b/2];O--;)for(M=x;M--;){I=_;t:{for(;I--;)for(S=_;S--;)if(C[4*((M*_+I)*y+(O*_+S))+3]){E.push([O,M]),O<F[3]&&(F[3]=O),O>F[1]&&(F[1]=O),M<F[0]&&(F[0]=M),M>F[2]&&(F[2]=M),o&&(h.fillStyle="rgba(255, 0, 0, 0.5)",h.fillRect(O*_,M*_,_-.5,_-.5));break t}o&&(h.fillStyle="rgba(0, 0, 255, 0.5)",h.fillRect(O*_,M*_,_-.5,_-.5))}}return o&&(h.fillStyle="rgba(0, 255, 0, 0.5)",h.fillRect(F[3]*_,F[0]*_,(F[1]-F[3]+1)*_,(F[2]-F[0]+1)*_)),{mu:a,occupied:E,bounds:F,gw:b,gh:x,fillTextOffsetX:g,fillTextOffsetY:w,fillTextWidth:c,fillTextHeight:f,fontSize:n}},H=function(t,e,i,o,n){for(var a=n.length;a--;){var r=t+n[a][0],s=e+n[a][1];if(r>=v||s>=g||r<0||s<0){if(!d.drawOutOfBound)return!1}else if(!p[r][s])return!1}return!0};f.drawItem=function(t,e){t&&(N(t.gx,t.gy,t.info,t.word,t.weight,t.distance,t.theta,t.rotateDeg,t.attributes,t.i,t.highlight),G(t.gx,t.gy,t.gw,t.gh,t.info,t.item,t.i))};var X=function(t,e,i,o,n,a,r,s){t.beginPath(0),t.save(),t.moveTo(e+a,i),t.lineTo(e+o-a,i),t.arcTo(e+o,i,e+o,i+a,a),t.lineTo(e+o,i+n-a),t.arcTo(e+o,i+n,e+o-a,i+n,a),t.lineTo(e+a,i+n),t.arcTo(e,i+n,e,i+n-a,a),t.lineTo(e,i+a),t.arcTo(e,i,e+a,i,a),t.closePath(),t.fillStyle=r,t.fill(),t.lineWidth="1",t.strokeStyle=s,t.stroke(),t.restore()},Y=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,o=t.toLowerCase();if(o&&i.test(o)){if(4===o.length){for(var n="#",a=1;a<4;a+=1)n+=o.slice(a,a+1).concat(o.slice(a,a+1));o=n}for(var r=[],s=1;s<7;s+=2)r.push(parseInt("0x"+o.slice(s,s+2)));return"rgba("+r.join(",")+","+e+")"}return o.startsWith("rgba")?o.split(",").map(function(t,e){return 3===e&&(t=" 0.2)"),t}).join(","):o},N=function(i,n,a,r,s,l,h,c,f,u,m){var p,v=a.fontSize;p=y?y(r,s,v,l,h):d.color;var g;g=T?T(r,s,v):d.fontWeight;var w;w=I?I(r,s,v):d.classes;var x,b=a.bounds;x={x:(i+b[3])*_,y:(n+b[0])*_,w:(b[1]-b[3]+1)*_,h:(b[2]-b[0]+1)*_};var k,C,M,S=!1,E="left";"[object Array]"===Object.prototype.toString.call(p)&&(k=p[u%p.length],p=k,"[object Array]"===Object.prototype.toString.call(k)&&(S=!0),S&&"[object Number]"!==Object.prototype.toString.call(k[k.length-1])&&(k[k.length]=0),E=0===k[k.length-1]?"top":"left"),M=JSON.parse(JSON.stringify(p)),t.forEach(function(t,s){if(t.getContext){var l=t.getContext("2d"),h=a.mu;if(l.save(),l.scale(1/h,1/h),l.font=g+" "+(v*h).toString(10)+"px "+d.fontFamily,S){var u=l.measureText(r).width;C=l.createLinearGradient("top"!==E?-u/2:0,"top"===E?-v/2:0,"top"!==E?u/2:0,"top"===E?v/2:0);for(var s=0;s<k.length-1;s++)C.addColorStop(s/(k.length-2),k[s]);p=C}if(l.fillStyle=p,l.translate((i+a.gw/2)*_*h,(n+a.gh/2)*_*h),m){var x;if(S){x=l.createLinearGradient("top"!==E?-a.fillTextOffsetX*h-4/h/2:0,"top"===E?-a.fillTextOffsetY*h-4/h/2:0,"top"!==E?a.fillTextOffsetX*h-4/h/2:0,"top"===E?a.fillTextOffsetY*h-4/h/2:0);for(var s=0;s<k.length-1;s++)x.addColorStop(s/(k.length-2),Y(k[k.length-2-s],.2))}X(l,a.fillTextOffsetX*h-2/h,a.fillTextOffsetY*h-2/h,l.measureText(r).width+4/h,v+4/h,4/h,S?x:Y(k?k:p,.2),S?k[0]:k?k:p)}l.shadowColor=e.shadowColor,l.shadowOffsetX=e.shadowOffsetX,l.shadowOffsetY=e.shadowOffsetY,l.shadowBlur=e.shadowBlur,0!==c&&l.rotate(-c),l.textBaseline="middle",l.fillText(r,a.fillTextOffsetX*h,(a.fillTextOffsetY+.5*v)*h),l.restore()}else{S&&(p=k);var b=document.createElement("div"),y=document.createElement("span"),M="";M="rotate("+-c/Math.PI*180+"deg) ",1!==a.mu&&(M+="translateX(-"+a.fillTextWidth/4+"px) scale("+1/a.mu+")");var T=o({position:"absolute",display:"block",font:g+" "+v*a.mu+"px "+d.fontFamily,left:(i+a.gw/2)*_+a.fillTextOffsetX+"px",top:(n+a.gh/2)*_+a.fillTextOffsetY+"px",width:a.fillTextWidth+"px","box-sizing":"border-box","border-radius":"4px","border-style":"solid","border-width":"1px","border-color":"transparent",lineHeight:v+"px",whiteSpace:"nowrap",transform:M,webkitTransform:M,msTransform:M,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"},"font",g+" "+v*a.mu+"px "+d.fontFamily),I={display:"block",font:g+" "+v*a.mu+"px "+d.fontFamily,filter:"drop-shadow("+e.shadowOffsetX+"px "+e.shadowOffsetY+"px "+e.shadowBlur+"px "+e.shadowColor+")"};m&&(T=Object.assign(T,o({"border-color":S?p[0]:p,"border-style":"solid","border-width":"1px"},"border-color",S?p[0]:p)),S?T.backgroundImage="-webkit-linear-gradient("+E+","+p.filter(function(t,e){return e!=p.length-1}).map(function(t){return Y(t,.2)}).join(",")+")":T.backgroundColor=Y(p,.2)),p&&("[object Array]"===Object.prototype.toString.call(p)&&(I=Object.assign({webkitBackgroundClip:"text",webkitTextFillColor:"transparent",backgroundImage:"-webkit-linear-gradient("+E+","+p.filter(function(t,e){return e!=p.length-1}).join(",")+")"},I)),I.color=p),y.textContent=r;for(var O in T)b.style[O]=T[O];for(var O in I)y.style[O]=I[O];if(f)for(var F in f)y.setAttribute(F,f[F]);w&&(y.className+=w),b.appendChild(y),t.appendChild(b)}})},q=function(e,i,o,n,a,r){if(!(e>=v||i>=g||e<0||i<0)){if(p[e][i]=!1,o){var s=t[0].getContext("2d");s.fillRect(e*_,i*_,k,k)}O&&(F[e][i]={item:a,dimension:n,index:r})}},G=function(e,i,o,n,a,r,s){var l,h=a.occupied,c=d.drawMask;c&&(l=t[0].getContext("2d"),l.save(),l.fillStyle=d.maskColor);var f;if(O){var u=a.bounds;f={x:(e+u[3])*_,y:(i+u[0])*_,w:(u[1]-u[3]+1)*_,h:(u[2]-u[0]+1)*_}}for(var m=h.length;m--;){var p=e+h[m][0],w=i+h[m][1];p>=v||w>=g||p<0||w<0||q(p,w,c,f,r,s)}c&&l.restore()},J=function(t,e){var i,o,n,a,r=e;Array.isArray(t)?(i=t[0],o=t[1],a=t[2]):(i=t.word,o=t.weight,n=t.attributes,a=t.highlight);var s=W(),h=D(i,o,s);if(!h)return!1;if(B())return!1;if(!d.drawOutOfBound){var c=h.bounds;if(c[1]-c[3]+1>v||c[2]-c[0]+1>g)return!1}for(var u=x+1,m=function(e,r){var s=Math.floor(e[0]-h.gw/2),l=Math.floor(e[1]-h.gh/2),c=h.gw,d=h.gh;if(!H(s,l,c,d,h.occupied))return!1;var m={gx:s,gy:l,info:h,word:i,weight:o,distance:x-u,theta:e[2],attributes:n,item:t,i:r,highlight:a};return f.words.push(m),m};u--;){var p=A(x-u);d.shuffle&&(p=[].concat(p),l(p));for(var w,e=0;e<p.length;e++){var b=m(p[e],r);if(b){w=b;break}}if(w)return w}return!1},U=function(e,i,o){return i?!t.some(function(t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!0,i,o||{}),!t.dispatchEvent(n)},this):void t.forEach(function(t){var n=document.createEvent("CustomEvent");n.initCustomEvent(e,!0,i,o||{}),t.dispatchEvent(n)},this)},$=function(){var e=i;if(e.getContext)v=Math.ceil(e.width/_),g=Math.ceil(e.height/_);else{var o=e.getBoundingClientRect();v=Math.ceil(o.width/_),g=Math.ceil(o.height/_)}if(U("wordcloudstart",!0)){w=d.origin?[d.origin[0]/_,d.origin[1]/_]:[v/2,g/2],x=Math.floor(Math.sqrt(v*v+g*g)),p=[];var n,r,s;if(t.forEach(function(t){if(t.getContext){var e=t.getContext("2d");e.fillStyle=d.backgroundColor,e.clearRect(0,0,v*(_+1),g*(_+1)),e.fillRect(0,0,v*(_+1),g*(_+1))}else t.textContent="",t.style.backgroundColor=d.backgroundColor,t.style.position="relative"}),!e.getContext||d.clearCanvas)for(n=v;n--;)for(p[n]=[],r=g;r--;)p[n][r]=!0;else{var l=document.createElement("canvas").getContext("2d");l.fillStyle="#ffffff",l.fillRect(0,0,1,1);var c=l.getImageData(0,0,1,1).data,u=e.getContext("2d").getImageData(0,0,v*_,g*_).data;n=v;for(var m,y;n--;)for(p[n]=[],r=g;r--;){y=_;t:for(;y--;)for(m=_;m--;)for(s=4;s--;)if(u[4*((r*_+y)*v*_+(n*_+m))+s]!==c[s]){p[n][r]=!1;break t}p[n][r]!==!1&&(p[n][r]=!0)}u=l=c=void 0}if(d.hover||d.click){for(O=!0,n=v+1;n--;)F[n]=[];var k=function(t){t.preventDefault()};t.forEach(function(t){d.hover&&(t.addEventListener("mousemove",R),t.addEventListener("mouseout",P)),d.click&&(t.addEventListener("click",j),t.addEventListener("touchstart",j),t.addEventListener("touchend",k),t.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),t.addEventListener("wordcloudstart",function e(){t.removeEventListener("wordcloudstart",e),t.removeEventListener("mousemove",R),t.removeEventListener("mouseout",P),t.removeEventListener("click",j),t.removeEventListener("touchstart",j),t.removeEventListener("touchend",k),E=void 0})})}s=0;var C,M;0!==d.wait?(C=window.setTimeout,M=window.clearTimeout):(C=window.setImmediate,M=window.clearImmediate);var S=function(e,i){t.forEach(function(t){t.addEventListener(e,i)},this)},T=function(e,i){t.forEach(function(t){t.removeEventListener(e,i)},this)},I=function t(){T("wordcloudstart",t),M(z)};S("wordcloudstart",I);var z=C(function t(){if(s>=d.list.length)return M(z),U("wordcloudstop",!1),void T("wordcloudstart",I);b=(new Date).getTime();var e=J(d.list[s],s);f.drawItem(e);var i=!U("wordclouddrawn",!0,{item:d.list[s],drawn:e&&!0});return B()||i?(M(z),d.abort(),U("wordcloudabort",!1),U("wordcloudstop",!1),void T("wordcloudstart",I)):(s++,void(z=C(t,d.wait)))},d.wait);if(h){var L=h.getContext("2d"),A=a(L);h.width=h.width*A,h.height=h.height*A,L.scale(A,A)}}};return $(),this}};h.prototype.highlight=function(t,e){var i=this;i.elements.forEach(function(o,n){o.getContext?o.getContext("2d").clearRect(0,0,o.width,o.height):o.innerHTML="",i.words.forEach(function(o){e||(o.highlight=!1),o.i===t&&(o.highlight=!0),i.drawItem(o)})})},h.prototype.downplay=function(t,e){var i=this;i.elements.forEach(function(e,o){e.getContext?e.getContext("2d").clearRect(0,0,e.width,e.height):e.innerHTML="",i.words.forEach(function(e){e.i===t&&(e.highlight=!1),i.drawItem(e)})})},h.isSupported=r,h.minFontSize=s,i.WordCloud=h,n=[],a=function(){return h}.apply(e,n),!(void 0!==a&&(t.exports=a))}(this)}).call(window)}])});