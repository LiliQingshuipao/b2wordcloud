!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.B2wordcloud=e():t.B2wordcloud=e()}(this,function(){return function(t){function e(i){if(o[i])return o[i].exports;var a=o[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){var o;for(o in e)t[o]=t[o]&&"[object Object]"===t[o].toString()?a(t[o],e[o]):t[o]=e[o];return t}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),r=o(1),s=e.B2wordcloud=function(){function t(e,o){i(this,t),this._wrapper=e,this._wrapper.style.position="relative",this._container=null,this._tooltip=null,this._options=a({renderer:"canvas",tooltip:{show:!0,formatter:null}},o),this._wordcloud2=null,this._maskCanvas=null,this._tempCanvas=null,this._init()}return n(t,[{key:"_init",value:function(){this._initContainer(),this._setOptions()}},{key:"_initContainer",value:function(){"div"===this._options.renderer?(this._container=document.createElement("div"),this._container.style.width="100%",this._container.style.height="100%",this._createTempCanvas()):"canvas"===this._options.renderer&&(this._container=document.createElement("canvas"),this._setCanvasSize()),this._wrapper.appendChild(this._container)}},{key:"_createTempCanvas",value:function(){this._tempCanvas=document.createElement("canvas"),this._setCanvasSize(this._tempCanvas)}},{key:"_initTooltip",value:function(){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className=this._options.tooltip.className||"",this._tooltip.style.backgroundColor=this._options.tooltip.backgroundColor||"rgba(0,0,0,0.8)",this._tooltip.style.color="#fff",this._tooltip.style.padding="5px",this._tooltip.style.borderRadius="5px",this._tooltip.style.fontSize="13px",this._tooltip.style.lineHeight="1.4",this._tooltip.style.webkitTransition="left 0.2s, top 0.2s",this._tooltip.style.transition="left 0.2s, top 0.2s",this._tooltip.style.position="absolute",this._tooltip.style.whiteSpace="nowrap",this._tooltip.style.zIndex="999",this._tooltip.style.display="none"),document.body.appendChild(this._tooltip)}},{key:"_setCanvasSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._container,e=this._wrapper.clientWidth,o=this._wrapper.clientHeight;t.width=e,t.height=o}},{key:"_setOptions",value:function(){var t=this;if(this._fixWeightFactor(this._options),this._options.tooltip.show){this._initTooltip();var e=void 0,o=void 0,i=void 0,a=void 0,n=this._options.hover,r=this._options.mouseout;this._options.mouseout=function(){r&&r(),t._tooltip.style.display="none"},this._options.hover=function(r,s,l){if(n&&n(r,s,l),r){var h=r[0]+": "+r[1];"[object Function]"===Object.prototype.toString.call(t._options.tooltip.formatter)&&(h=t._options.tooltip.formatter(r)),t._tooltip.style.display="block",e=t._tooltip.clientWidth,o=t._tooltip.clientHeight,i=o+15,a=e/2+5,t._tooltip.style.position="absolute",t._tooltip.style.top=l.pageY-i+"px",t._tooltip.style.left=l.pageX-a+"px",t._tooltip.innerHTML=h}else t._tooltip.style.display="none"}}this._options&&this._options.maskImage?this._maskImage():this._render()}},{key:"_maskImage",value:function(){var t=this,e=window.document.createElement("img");e.crossOrigin="Anonymous",e.src=this._options.maskImage,e.onload=function(){t._maskCanvas=document.createElement("canvas"),t._maskCanvas.width=e.width,t._maskCanvas.height=e.height;var o=t._maskCanvas.getContext("2d");o.drawImage(e,0,0,e.width,e.height);for(var i=o.getImageData(0,0,t._maskCanvas.width,t._maskCanvas.height),a=o.createImageData(i),n=0;n<i.data.length;n+=4){var r=i.data[n]+i.data[n+1]+i.data[n+2],s=i.data[n+3];s<128||r>384?(a.data[n]=a.data[n+1]=a.data[n+2]=255,a.data[n+3]=0):(a.data[n]=a.data[n+1]=a.data[n+2]=0,a.data[n+3]=255)}o.putImageData(a,0,0),t._render()}}},{key:"_render",value:function(){if(this._maskCanvas){this._options.clearCanvas=!1;var t=document.createElement("canvas").getContext("2d");t.fillStyle=this._options.backgroundColor||"#fff",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1).data,o=document.createElement("canvas");o.width="canvas"===this._options.renderer?this._container.width:this._container.clientWidth,o.height="canvas"===this._options.renderer?this._container.height:this._container.clientHeight;var i=o.getContext("2d");i.drawImage(this._maskCanvas,0,0,this._maskCanvas.width,this._maskCanvas.height,0,0,o.width,o.height);for(var a=i.getImageData(0,0,o.width,o.height),n=i.createImageData(a),s=0;s<a.data.length;s+=4)a.data[s+3]>128?(n.data[s]=e[0],n.data[s+1]=e[1],n.data[s+2]=e[2],n.data[s+3]=e[3]):(n.data[s]=e[0],n.data[s+1]=e[1],n.data[s+2]=e[2],n.data[s+3]=e[3]?e[3]-1:0);i.putImageData(n,0,0);var l=this._tempCanvas?this._tempCanvas:this._container;i=l.getContext("2d"),i.drawImage(o,0,0)}this._wordcloud2=r("canvas"===this._options.renderer?this._container:[this._tempCanvas,this._container],this._options)}},{key:"_fixWeightFactor",value:function(t){if(t.maxFontSize="number"==typeof t.maxFontSize?t.maxFontSize:36,t.minFontSize="number"==typeof t.minFontSize?t.minFontSize:6,t.list&&t.list.length>0){for(var e=Number(t.list[0][1]),o=0,i=0,a=t.list.length;i<a;i++){var n=Number(t.list[i][1]);e>n&&(e=n),o<n&&(o=n)}if(o>e){var r="number"==typeof t.fontSizeFactor?t.fontSizeFactor:.1,s=(t.maxFontSize-t.minFontSize)/(Math.pow(o,r)-Math.pow(e,r)),l=t.maxFontSize-s*Math.pow(o,r);t.weightFactor=function(t){return Math.ceil(s*Math.pow(t,r)+l)}}else t.weightFactor=function(e){return t.minFontSize}}}},{key:"resize",value:function(){"canvas"===this._options.renderer?this._setCanvasSize():"div"===this._options.renderer&&(this._container.textContent=""),this._render()}},{key:"dispatchAction",value:function(t){switch(t.type){case"highlight":this._wordcloud2.highlight(t.dataIndex,t.keepAlive);break;case"downplay":this._wordcloud2.downplay(t.dataIndex,t.keepAlive)}}}]),t}();t.exports=s},function(t,e,o){function i(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var a,n;(function(){/*!
	   * wordcloud2.js
	   * http://timdream.org/wordcloud2.js/
	   *
	   * Copyright 2011 - 2013 Tim Chien
	   * Released under the MIT license
	   */
"use strict";window.setImmediate||(window.setImmediate=function(){return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var t=[void 0],e="zero-timeout-message",o=function(o){var i=t.length;return t.push(o),window.postMessage(e+i.toString(36),"*"),i};return window.addEventListener("message",function(o){if("string"==typeof o.data&&o.data.substr(0,e.length)===e){o.stopImmediatePropagation();var i=parseInt(o.data.substr(e.length),36);t[i]&&(t[i](),t[i]=void 0)}},!0),window.clearImmediate=function(e){t[e]&&(t[e]=void 0)},o}()||function(t){window.setTimeout(t,0)}}()),window.clearImmediate||(window.clearImmediate=function(){return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(t){window.clearTimeout(t)}}()),function(o){var r=function(){var t=document.createElement("canvas");if(!t||!t.getContext)return!1;var e=t.getContext("2d");return!!e&&(!!e.getImageData&&(!!e.fillText&&(!!Array.prototype.some&&!!Array.prototype.push)))}(),s=function(){if(r){for(var t,e,o=document.createElement("canvas").getContext("2d"),i=20;i;){if(o.font=i.toString(10)+"px sans-serif",o.measureText("Ｗ").width===t&&o.measureText("m").width===e)return i+1;t=o.measureText("Ｗ").width,e=o.measureText("m").width,i--}return 0}}(),l=function(t){for(var e,o,i=t.length;i;e=Math.floor(Math.random()*i),o=t[--i],t[i]=t[e],t[e]=o);return t},h=function t(e,o){function a(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"}if(r){Array.isArray(e)||(e=[e]),e.forEach(function(t,o){if("string"==typeof t){if(e[o]=document.getElementById(t),!e[o])throw"The element id specified is not found."}else if(!t.tagName&&!t.appendChild)throw"You must pass valid HTML elements, or ID of the element."});var n={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null,cursorWhenHover:"pointer",mouseout:null},h=[];if(o)for(var c in o)c in n&&(n[c]=o[c]);if("function"!=typeof n.weightFactor){var d=n.weightFactor;n.weightFactor=function(t){return t*d}}if("function"!=typeof n.shape)switch(n.shape){case"circle":default:n.shape="circle";break;case"cardioid":n.shape=function(t){return 1-Math.sin(t)};break;case"diamond":n.shape=function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))};break;case"square":n.shape=function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))};break;case"triangle-forward":n.shape=function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"triangle":case"triangle-upright":n.shape=function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"pentagon":n.shape=function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))};break;case"star":n.shape=function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}n.gridSize=Math.max(Math.floor(n.gridSize),4);var f,u,p,m,v,g,w,b=n.gridSize,x=b-n.maskGapWidth,y=Math.abs(n.maxRotation-n.minRotation),_=Math.abs(Math.floor(n.rotationSteps)),M=Math.min(n.maxRotation,n.minRotation);switch(n.color){case"random-dark":w=function(){return a(10,50)};break;case"random-light":w=function(){return a(50,90)};break;default:"function"==typeof n.color&&(w=n.color)}var C;"function"==typeof n.fontWeight&&(C=n.fontWeight);var k=null;"function"==typeof n.classes&&(k=n.classes);var T,S=!1,I=[],E=function(t){var e,o,i=t.currentTarget,a=i.getBoundingClientRect();t.touches?(e=t.touches[0].clientX,o=t.touches[0].clientY):(e=t.clientX,o=t.clientY);var n=e-a.left,r=o-a.top,s=Math.floor(n*(i.width/a.width||1)/b),l=Math.floor(r*(i.height/a.height||1)/b);return I[s][l]},O=function(){n.mouseout()},F=function(t){var e=E(t);if(T!==e){if(T=e,!e)return n.hover(void 0,void 0,t),void(t.target.style.cursor="default");"pointer"===n.cursorWhenHover&&(t.target.style.cursor="pointer"),n.hover(e.item,e.dimension,t)}},z=function(t){var e=E(t);e&&(n.click(e.item,e.dimension,t,e.color,e.index),t.preventDefault())},R=[],j=function(t){if(R[t])return R[t];var e=8*t,o=e,i=[];for(0===t&&i.push([m[0],m[1],0]);o--;){var a=1;"circle"!==n.shape&&(a=n.shape(o/e*2*Math.PI)),i.push([m[0]+t*a*Math.cos(-o/e*2*Math.PI),m[1]+t*a*Math.sin(-o/e*2*Math.PI)*n.ellipticity,o/e*2*Math.PI])}return R[t]=i,i},L=function(){return n.abortThreshold>0&&(new Date).getTime()-g>n.abortThreshold},P=function(){return 0===n.rotateRatio?0:Math.random()>n.rotateRatio?0:0===y?M:_>0?M+Math.floor(Math.random()*_)*y/(_-1):M+Math.random()*y},A=function(t,e,o){var i=!0,a=n.weightFactor(e);if(a<=n.minSize)return!1;var r=1;a<s&&(r=function(){for(var t=2;t*a<s;)t+=2;return t}());var l;l=C?C(t,e,a):n.fontWeight;var h=document.createElement("canvas"),c=h.getContext("2d",{willReadFrequently:!0});c.font=l+" "+(a*r).toString(10)+"px "+n.fontFamily;var d=c.measureText(t).width/r,f=Math.max(a*r,c.measureText("m").width,c.measureText("Ｗ").width)/r,u=d+2*f,p=3*f,m=Math.ceil(u/b),v=Math.ceil(p/b);u=m*b,p=v*b;var g=-d/2,w=.4*-f,x=Math.ceil((u*Math.abs(Math.sin(o))+p*Math.abs(Math.cos(o)))/b),y=Math.ceil((u*Math.abs(Math.cos(o))+p*Math.abs(Math.sin(o)))/b),_=y*b,M=x*b;h.setAttribute("width",_),h.setAttribute("height",M),i&&(document.body.appendChild(h),c.save()),c.scale(1/r,1/r),c.translate(_*r/2,M*r/2),c.rotate(-o),c.font=l+" "+(a*r).toString(10)+"px "+n.fontFamily,c.fillStyle="#000",c.textBaseline="middle",c.fillText(t,g*r,(w+.5*a)*r);var k=c.getImageData(0,0,_,M).data;if(L())return!1;i&&(c.strokeRect(g*r,w,d*r,f*r),c.restore());for(var T,S,I,E=[],O=y,F=[x/2,y/2,x/2,y/2];O--;)for(T=x;T--;){I=b;t:{for(;I--;)for(S=b;S--;)if(k[4*((T*b+I)*_+(O*b+S))+3]){E.push([O,T]),O<F[3]&&(F[3]=O),O>F[1]&&(F[1]=O),T<F[0]&&(F[0]=T),T>F[2]&&(F[2]=T),i&&(c.fillStyle="rgba(255, 0, 0, 0.5)",c.fillRect(O*b,T*b,b-.5,b-.5));break t}i&&(c.fillStyle="rgba(0, 0, 255, 0.5)",c.fillRect(O*b,T*b,b-.5,b-.5))}}return i&&(c.fillStyle="rgba(0, 255, 0, 0.5)",c.fillRect(F[3]*b,F[0]*b,(F[1]-F[3]+1)*b,(F[2]-F[0]+1)*b)),{mu:r,occupied:E,bounds:F,gw:y,gh:x,fillTextOffsetX:g,fillTextOffsetY:w,fillTextWidth:d,fillTextHeight:f,fontSize:a}},W=function(t,e,o,i,a){for(var r=a.length;r--;){var s=t+a[r][0],l=e+a[r][1];if(s>=u||l>=p||s<0||l<0){if(!n.drawOutOfBound)return!1}else if(!f[s][l])return!1}return!0},D=function(t,e){X(t.gx,t.gy,t.info,t.word,t.weight,t.distance,t.theta,t.rotateDeg,t.attributes,t.i,t.highlight),N(t.gx,t.gy,t.gw,t.gh,t.info,t.item,t.i)},B=function(t,e,o,i,a,n,r,s){t.beginPath(0),t.save(),t.moveTo(e+n,o),t.lineTo(e+i-n,o),t.arcTo(e+i,o,e+i,o+n,n),t.lineTo(e+i,o+a-n),t.arcTo(e+i,o+a,e+i-n,o+a,n),t.lineTo(e+n,o+a),t.arcTo(e,o+a,e,o+a-n,n),t.lineTo(e,o+n),t.arcTo(e,o,e+n,o,n),t.closePath(),t.fillStyle=r,t.fill(),t.lineWidth="1",t.strokeStyle=s,t.stroke(),t.restore()},H=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,i=t.toLowerCase();if(i&&o.test(i)){if(4===i.length){for(var a="#",n=1;n<4;n+=1)a+=i.slice(n,n+1).concat(i.slice(n,n+1));i=a}for(var r=[],s=1;s<7;s+=2)r.push(parseInt("0x"+i.slice(s,s+2)));return"rgba("+r.join(",")+","+e+")"}return i},X=function(t,a,r,s,l,h,c,d,f,u,p){var m,v=r.fontSize;m=w?w(s,l,v,h,c):n.color;var g;g=C?C(s,l,v):n.fontWeight;var x;x=k?k(s,l,v):n.classes;var y,_=r.bounds;y={x:(t+_[3])*b,y:(a+_[0])*b,w:(_[1]-_[3]+1)*b,h:(_[2]-_[0]+1)*b};var M,T,S,I=!1,E="left";"[object Array]"===Object.prototype.toString.call(m)&&(M=m[u%m.length],m=M,"[object Array]"===Object.prototype.toString.call(M)&&(I=!0),I&&"[object Number]"!==Object.prototype.toString.call(M[M.length-1])&&(M[M.length]=0),E=0===M[M.length-1]?"top":"left"),S=JSON.parse(JSON.stringify(m)),e.forEach(function(e,l){if(e.getContext){var h=e.getContext("2d"),c=r.mu;if(h.save(),h.scale(1/c,1/c),h.font=g+" "+(v*c).toString(10)+"px "+n.fontFamily,I){var u=h.measureText(s).width;T=h.createLinearGradient("top"!==E?-u/2:0,"top"===E?-v/2:0,"top"!==E?u/2:0,"top"===E?v/2:0);for(var l=0;l<M.length-1;l++)T.addColorStop(l/(M.length-2),M[l]);m=T}if(r.color=S,h.fillStyle=m,h.translate((t+r.gw/2)*b*c,(a+r.gh/2)*b*c),p){var w;if(I){w=h.createLinearGradient("top"!==E?-r.fillTextOffsetX*c-4/c/2:0,"top"===E?-r.fillTextOffsetY*c-4/c/2:0,"top"!==E?r.fillTextOffsetX*c-4/c/2:0,"top"===E?r.fillTextOffsetY*c-4/c/2:0);for(var l=0;l<M.length-1;l++)w.addColorStop(l/(M.length-2),H(M[M.length-2-l],.2))}B(h,r.fillTextOffsetX*c-2/c,r.fillTextOffsetY*c-2/c,h.measureText(s).width+4/c,v+4/c,4/c,I?w:H(M,.2),I?M[0]:M)}h.shadowColor=o.shadowColor,h.shadowOffsetX=o.shadowOffsetX,h.shadowOffsetY=o.shadowOffsetY,h.shadowBlur=o.shadowBlur,0!==d&&h.rotate(-d),h.textBaseline="middle",h.fillText(s,r.fillTextOffsetX*c,(r.fillTextOffsetY+.5*v)*c),h.restore()}else{I&&(m=M);var y=document.createElement("div"),_=document.createElement("span"),C="";C="rotate("+-d/Math.PI*180+"deg) ",1!==r.mu&&(C+="translateX(-"+r.fillTextWidth/4+"px) scale("+1/r.mu+")");var k={position:"absolute",left:(t+r.gw/2)*b+r.fillTextOffsetX+"px",top:(a+r.gh/2)*b+r.fillTextOffsetY+"px",width:r.fillTextWidth+"px","box-sizing":"border-box","border-radius":"4px","border-style":"solid","border-width":"1px","border-color":"transparent",lineHeight:v+"px",whiteSpace:"nowrap",transform:C,webkitTransform:C,msTransform:C,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%",font:g+" "+v*r.mu+"px "+n.fontFamily},O={display:"block",font:g+" "+v*r.mu+"px "+n.fontFamily,filter:"drop-shadow("+o.shadowOffsetX+"px "+o.shadowOffsetY+"px "+o.shadowBlur+"px "+o.shadowColor+")"};p&&(k=Object.assign(k,i({"border-color":I?m[0]:m,"border-style":"solid","border-width":"1px"},"border-color",I?m[0]:m)),I?k.backgroundImage="-webkit-linear-gradient("+E+","+m.filter(function(t,e){return e!=m.length-1}).map(function(t){return H(t,.2)}).join(",")+")":k.backgroundColor=H(m,.2)),m&&("[object Array]"===Object.prototype.toString.call(m)&&(O=Object.assign({webkitBackgroundClip:"text",webkitTextFillColor:"transparent",backgroundImage:"-webkit-linear-gradient("+E+","+m.filter(function(t,e){return e!=m.length-1}).join(",")+")"},O)),O.color=m),_.textContent=s;for(var F in k)y.style[F]=k[F];for(var F in O)_.style[F]=O[F];if(f)for(var z in f)_.setAttribute(z,f[z]);x&&(_.className+=x),y.appendChild(_),e.appendChild(y)}})},Y=function(t,o,i,a,n,r,s){if(!(t>=u||o>=p||t<0||o<0)){if(f[t][o]=!1,i){var l=e[0].getContext("2d");l.fillRect(t*b,o*b,x,x)}S&&(I[t][o]={item:n,dimension:a,color:r,index:s})}},N=function(t,o,i,a,r,s,l){var h,c=r.occupied,d=n.drawMask;d&&(h=e[0].getContext("2d"),h.save(),h.fillStyle=n.maskColor);var f;if(S){var m=r.bounds;f={x:(t+m[3])*b,y:(o+m[0])*b,w:(m[1]-m[3]+1)*b,h:(m[2]-m[0]+1)*b}}for(var v=c.length;v--;){var g=t+c[v][0],w=o+c[v][1];g>=u||w>=p||g<0||w<0||Y(g,w,d,f,s,r.color,l)}d&&h.restore()},q=function(t,e){var o,i,a;Array.isArray(t)?(o=t[0],i=t[1]):(o=t.word,i=t.weight,a=t.attributes);var r=P(),s=A(o,i,r);if(!s)return!1;if(L())return!1;if(!n.drawOutOfBound){var c=s.bounds;if(c[1]-c[3]+1>u||c[2]-c[0]+1>p)return!1}for(var d=v+1,f=function(n){var r=Math.floor(n[0]-s.gw/2),l=Math.floor(n[1]-s.gh/2),c=s.gw,f=s.gh;return!!W(r,l,c,f,s.occupied)&&(h.push({gx:r,gy:l,info:s,word:o,weight:i,distance:v-d,theta:n[2],attributes:a,item:t,i:e,highlight:!1}),!0)};d--;){var m=j(v-d);n.shuffle&&(m=[].concat(m),l(m));var g=m.some(f);if(g)return!0}return!1},G=function(t,o,i){return o?!e.some(function(e){var a=document.createEvent("CustomEvent");return a.initCustomEvent(t,!0,o,i||{}),!e.dispatchEvent(a)},this):void e.forEach(function(e){var a=document.createEvent("CustomEvent");a.initCustomEvent(t,!0,o,i||{}),e.dispatchEvent(a)},this)},J=function(){var t=e[0];if(t.getContext)u=Math.ceil(t.width/b),p=Math.ceil(t.height/b);else{var o=t.getBoundingClientRect();u=Math.ceil(o.width/b),p=Math.ceil(o.height/b)}if(G("wordcloudstart",!0)){m=n.origin?[n.origin[0]/b,n.origin[1]/b]:[u/2,p/2],v=Math.floor(Math.sqrt(u*u+p*p)),f=[];var i,a,r;if(!t.getContext||n.clearCanvas)for(e.forEach(function(t){if(t.getContext){var e=t.getContext("2d");e.fillStyle=n.backgroundColor,e.clearRect(0,0,u*(b+1),p*(b+1)),e.fillRect(0,0,u*(b+1),p*(b+1))}else t.textContent="",t.style.backgroundColor=n.backgroundColor,t.style.position="relative"}),i=u;i--;)for(f[i]=[],a=p;a--;)f[i][a]=!0;else{var s=document.createElement("canvas").getContext("2d");s.fillStyle=n.backgroundColor,s.fillRect(0,0,1,1);var l=s.getImageData(0,0,1,1).data,c=t.getContext("2d").getImageData(0,0,u*b,p*b).data;i=u;for(var d,w;i--;)for(f[i]=[],a=p;a--;){w=b;t:for(;w--;)for(d=b;d--;)for(r=4;r--;)if(c[4*((a*b+w)*u*b+(i*b+d))+r]!==l[r]){f[i][a]=!1;break t}f[i][a]!==!1&&(f[i][a]=!0)}c=s=l=void 0}if(n.hover||n.click){for(S=!0,i=u+1;i--;)I[i]=[];var x=function(t){t.preventDefault()};e.forEach(function(t){n.hover&&(t.addEventListener("mousemove",F),t.addEventListener("mouseout",O)),n.click&&(t.addEventListener("click",z),t.addEventListener("touchstart",z),t.addEventListener("touchend",x),t.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),t.addEventListener("wordcloudstart",function e(){t.removeEventListener("wordcloudstart",e),t.removeEventListener("mousemove",F),t.removeEventListener("mouseout",O),t.removeEventListener("click",z),t.removeEventListener("touchstart",z),t.removeEventListener("touchend",x),T=void 0})})}r=0;var y,_;0!==n.wait?(y=window.setTimeout,_=window.clearTimeout):(y=window.setImmediate,_=window.clearImmediate);var M=function(t,o){e.forEach(function(e){e.addEventListener(t,o)},this)},C=function(t,o){e.forEach(function(e){e.removeEventListener(t,o)},this)},k=function t(){C("wordcloudstart",t),_(E)};M("wordcloudstart",k);var E=y(function t(){if(r>=n.list.length)return _(E),G("wordcloudstop",!1),void C("wordcloudstart",k);g=(new Date).getTime();var e=q(n.list[r],r);D(h[r]);var o=!G("wordclouddrawn",!0,{item:n.list[r],drawn:e});return L()||o?(_(E),n.abort(),G("wordcloudabort",!1),G("wordcloudstop",!1),void C("wordcloudstart",k)):(r++,void(E=y(t,n.wait)))},n.wait)}};return J(),t.highlight=function(t,o){e.forEach(function(e,i){e.getContext?e.getContext("2d").clearRect(0,0,e.width,e.height):e.innerHTML="",h.forEach(function(e){o||(e.highlight=!1),e.i===t&&(e.highlight=!0),D(e)})})},t.downplay=function(t,o){e.forEach(function(e,o){e.getContext?e.getContext("2d").clearRect(0,0,e.width,e.height):e.innerHTML="",h.forEach(function(e){e.i===t&&(e.highlight=!1),D(e)})})},t}};h.isSupported=r,h.minFontSize=s,o.WordCloud=h,a=[],n=function(){return h}.apply(e,a),!(void 0!==n&&(t.exports=n))}(this)}).call(window)}])});